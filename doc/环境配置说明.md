# ğŸ”§ ç¯å¢ƒé…ç½®è¯´æ˜

## å¿…éœ€ç¯å¢ƒå˜é‡

### Supabase é…ç½®
```bash
# Supabase é¡¹ç›®URL
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co

# Supabase åŒ¿åå¯†é’¥
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key

# å¯ç”¨åç«¯åŒæ­¥
NEXT_PUBLIC_ENABLE_BACKEND_SYNC=true
```

### å¼€å‘ç¯å¢ƒé…ç½®
```bash
# ç¯å¢ƒæ¨¡å¼
NODE_ENV=development

# ç«¯å£é…ç½®ï¼ˆå¯é€‰ï¼‰
PORT=3000
```

## è·å– Supabase é…ç½®

### 1. åˆ›å»º Supabase é¡¹ç›®
1. è®¿é—® [Supabase Dashboard](https://supabase.com/dashboard)
2. ç‚¹å‡» "New Project"
3. å¡«å†™é¡¹ç›®ä¿¡æ¯
4. ç­‰å¾…é¡¹ç›®åˆ›å»ºå®Œæˆ

### 2. è·å–é¡¹ç›®é…ç½®
1. è¿›å…¥é¡¹ç›® Dashboard
2. ç‚¹å‡» "Settings" â†’ "API"
3. å¤åˆ¶ä»¥ä¸‹ä¿¡æ¯ï¼š
   - **Project URL**: `https://your-project.supabase.co`
   - **anon public**: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`

### 3. é…ç½®æ•°æ®åº“
1. è¿›å…¥ "SQL Editor"
2. è¿è¡Œä»¥ä¸‹è¿ç§»ï¼š
   ```sql
   -- è¿è¡Œåˆå§‹schema
   \i supabase/migrations/20250124000001_initial_schema.sql
   
   -- è¿è¡Œè®¤è¯é›†æˆ
   \i supabase/migrations/20250124000002_auth_integration.sql
   ```

### 4. é…ç½®è®¤è¯
1. è¿›å…¥ "Authentication" â†’ "Settings"
2. å¯ç”¨ä»¥ä¸‹é€‰é¡¹ï¼š
   - âœ… Email/Password
   - âœ… Email confirmations
   - âœ… Email change confirmations
3. é…ç½®é‡å®šå‘URLï¼š
   ```
   http://localhost:3000/auth/callback
   https://yourdomain.com/auth/callback
   ```

## æœ¬åœ°å¼€å‘é…ç½®

### 1. åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp .env.example .env.local

# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano .env.local
```

### 2. é…ç½®å†…å®¹
```bash
# .env.local
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
NEXT_PUBLIC_ENABLE_BACKEND_SYNC=true
NODE_ENV=development
```

### 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
# å®‰è£…ä¾èµ–
pnpm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev
```

## ç”Ÿäº§ç¯å¢ƒé…ç½®

### 1. Vercel éƒ¨ç½²é…ç½®
åœ¨ Vercel Dashboard ä¸­è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
# ç”Ÿäº§ç¯å¢ƒå˜é‡
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
NEXT_PUBLIC_ENABLE_BACKEND_SYNC=true
NODE_ENV=production
```

### 2. åŸŸåé…ç½®
åœ¨ Supabase Dashboard ä¸­é…ç½®ï¼š
```
Authentication â†’ Settings â†’ Site URL
https://yourdomain.com

Authentication â†’ Settings â†’ Redirect URLs
https://yourdomain.com/auth/callback
```

## æµ‹è¯•é…ç½®

### 1. è¿è¡Œè®¤è¯æµ‹è¯•
```bash
# å®‰è£…æµ‹è¯•ä¾èµ–
pnpm add -D tsx

# è¿è¡Œè®¤è¯æµ‹è¯•
npx tsx scripts/test-auth.ts
```

### 2. æ‰‹åŠ¨æµ‹è¯•æµç¨‹
1. è®¿é—® `http://localhost:3000`
2. è‡ªåŠ¨é‡å®šå‘åˆ° `/auth`
3. æ³¨å†Œæ–°ç”¨æˆ·
4. éªŒè¯é‚®ç®±ï¼ˆå¼€å‘ç¯å¢ƒå¯èƒ½è·³è¿‡ï¼‰
5. ç™»å½•ç”¨æˆ·
6. æµ‹è¯•å‘å¸–åŠŸèƒ½

## æ•…éšœæ’é™¤

### 1. è¿æ¥ Supabase å¤±è´¥
**æ£€æŸ¥**ï¼š
- âœ… ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®
- âœ… Supabase é¡¹ç›®æ˜¯å¦æ­£å¸¸è¿è¡Œ
- âœ… ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥ç¯å¢ƒå˜é‡
echo $NEXT_PUBLIC_SUPABASE_URL
echo $NEXT_PUBLIC_SUPABASE_ANON_KEY

# æµ‹è¯•è¿æ¥
curl -H "apikey: $NEXT_PUBLIC_SUPABASE_ANON_KEY" \
     $NEXT_PUBLIC_SUPABASE_URL/rest/v1/
```

### 2. è®¤è¯å¤±è´¥
**æ£€æŸ¥**ï¼š
- âœ… é‚®ç®±éªŒè¯æ˜¯å¦å®Œæˆ
- âœ… å¯†ç æ˜¯å¦ç¬¦åˆè¦æ±‚
- âœ… ç”¨æˆ·æ˜¯å¦å·²æ³¨å†Œ

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥ Supabase æ—¥å¿—
# Dashboard â†’ Logs â†’ Auth
```

### 3. æƒé™é”™è¯¯
**æ£€æŸ¥**ï¼š
- âœ… RLS ç­–ç•¥æ˜¯å¦æ­£ç¡®é…ç½®
- âœ… ç”¨æˆ·æ˜¯å¦æœ‰ç›¸åº”æƒé™
- âœ… æ•°æ®åº“è¿æ¥æ˜¯å¦æ­£å¸¸

**è§£å†³**ï¼š
```sql
-- æ£€æŸ¥ RLS ç­–ç•¥
SELECT * FROM pg_policies WHERE tablename = 'profiles';

-- ä¸´æ—¶ç¦ç”¨ RLSï¼ˆä»…æµ‹è¯•ï¼‰
ALTER TABLE public.profiles DISABLE ROW LEVEL SECURITY;
```

## å®‰å…¨æ³¨æ„äº‹é¡¹

### 1. ç¯å¢ƒå˜é‡å®‰å…¨
- âŒ ä¸è¦å°† `.env` æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
- âœ… ä½¿ç”¨ `.env.example` ä½œä¸ºæ¨¡æ¿
- âœ… ç”Ÿäº§ç¯å¢ƒä½¿ç”¨å®‰å…¨çš„å¯†é’¥ç®¡ç†

### 2. Supabase å®‰å…¨
- âœ… å¯ç”¨ RLS ç­–ç•¥
- âœ… é…ç½®é€‚å½“çš„ CORS è®¾ç½®
- âœ… å®šæœŸè½®æ¢ API å¯†é’¥

### 3. ç”Ÿäº§ç¯å¢ƒ
- âœ… ä½¿ç”¨ HTTPS
- âœ… é…ç½®å®‰å…¨å¤´
- âœ… å¯ç”¨ CSP ç­–ç•¥

---

**é…ç½®çŠ¶æ€**: âœ… å®Œæˆ  
**æµ‹è¯•çŠ¶æ€**: â³ å¾…éªŒè¯  
**éƒ¨ç½²çŠ¶æ€**: â³ å¾…é…ç½®
