# 🧪 新架构测试指南

## ✅ 测试前准备

### 1. 启动项目
```bash
cd /Users/xukaikai/Desktop/Amazon产品4Me/Code/aha-lang
pnpm dev
```

### 2. 打开浏览器
访问: http://localhost:3000

### 3. 打开开发者工具
按 `F12` 或 `Cmd+Option+I`，查看Console日志

---

## 🎯 功能测试清单

### 一、浮动操作按钮 (FAB)

#### 1.1 基础交互
- [ ] 页面加载后，右下角出现蓝色圆形按钮
- [ ] 悬停按钮，显示"创建内容"提示
- [ ] 悬停时按钮有缩放效果 (1.05x)
- [ ] 悬停时图标旋转90度
- [ ] 点击按钮，展开两个选项卡片

#### 1.2 展开菜单
- [ ] 展开后显示两个卡片：
  - 🔵 **新增帖子** - "分享想法、图片、视频"
  - 🟣 **新增挑战** - "创建学习挑战、小说章节"
- [ ] 卡片有渐入动画
- [ ] 卡片悬停时有缩放和位移效果
- [ ] 主按钮变红色，图标变为X
- [ ] 再次点击主按钮，菜单收起

---

### 二、创建帖子流程

#### 2.1 打开模态框
- [ ] 点击"新增帖子"卡片
- [ ] 模态框从中心弹出，带缩放动画
- [ ] 背景变暗并模糊
- [ ] 模态框标题显示"新增帖子"
- [ ] 输入框自动获得焦点

#### 2.2 输入内容
- [ ] 输入框占位符显示"分享你的想法..."
- [ ] 输入文本，字符计数实时更新
- [ ] 字符数显示格式：`0/280`
- [ ] 超过280字，字符数变红色
- [ ] 超过280字，发布按钮禁用

#### 2.3 媒体选项
- [ ] 底部显示5个媒体按钮：
  - 📷 图片（蓝色）
  - 🎥 视频（绿色）
  - 🎵 音频（紫色）
  - 😊 表情（黄色）
  - # 标签（粉色）
- [ ] 悬停按钮有背景色变化

#### 2.4 提交帖子
- [ ] 输入内容："这是一条测试帖子 🎉"
- [ ] 点击"发布"按钮
- [ ] 看到Toast提示："发布帖子中..."
- [ ] 约1秒后，Toast变为："帖子发布成功! 🎉"
- [ ] 模态框自动关闭
- [ ] **新帖子出现在Feed列表最顶部**

#### 2.5 验证帖子
- [ ] 新帖子显示正确的内容
- [ ] 作者显示为"You"
- [ ] 时间显示"Just now"或"1s ago"
- [ ] 统计数据都是0（点赞、转发、评论等）
- [ ] 可以点赞新帖子

#### 2.6 控制台日志
```
[HomePage] Submitting content: { category: 'post', ... }
[createContent] Creating content: { category: 'post', ... }
[ContentDispatcher] Rule matched: { ruleId: 'post-text-detection', ... }
[createContentMock] Created: { id: 'post-...', type: 'text', ... }
[Mutation] Content created successfully: { id: 'post-...', ... }
```

---

### 三、创建挑战流程

#### 3.1 打开模态框
- [ ] 点击"新增挑战"卡片
- [ ] 模态框标题显示"新增挑战"
- [ ] 输入框占位符显示"描述这个学习挑战..."
- [ ] 字符限制为500字

#### 3.2 高级选项
- [ ] 点击右上角的✨图标
- [ ] 展开高级选项面板
- [ ] 显示"难度等级"选择器（1-5）
- [ ] 显示"预计时长"输入框
- [ ] 默认难度为3

#### 3.3 设置难度
- [ ] 点击难度按钮1-5
- [ ] 选中的按钮变蓝色并放大
- [ ] 其他按钮保持灰色

#### 3.4 提交挑战
- [ ] 输入内容："学习Harry Potter第一章"
- [ ] 设置难度：3
- [ ] 设置时长："30分钟"
- [ ] 点击"创建挑战"按钮
- [ ] Toast提示："创建挑战中..."
- [ ] Toast变为："挑战创建成功! 🎉"
- [ ] **新挑战出现在Feed列表顶部**

#### 3.5 验证挑战
- [ ] 新挑战显示正确的内容
- [ ] 如果被识别为小说类型，显示NovelCard样式
- [ ] 显示难度等级
- [ ] 显示预计时长

#### 3.6 控制台日志
```
[HomePage] Submitting content: { category: 'challenge', ... }
[createContent] Creating content: { category: 'challenge', ... }
[ContentDispatcher] Rule matched: { ruleId: 'challenge-novel-detection', ... }
[createContentMock] Created: { id: 'challenge-...', type: 'novel', ... }
```

---

### 四、智能分发测试

#### 4.1 纯文本帖子
**输入**:
```
这是一条纯文本帖子，没有任何媒体内容。
```

**预期**:
- 类型：`text`
- 渲染：TextCard
- 日志：`Rule matched: post-text-detection`

#### 4.2 媒体帖子
**输入**:
```
text: "看看这张图片！"
media: [{ type: 'image', url: '...' }]
```

**预期**:
- 类型：`media`
- 渲染：MediaCard
- 日志：`Rule matched: post-media-detection`

#### 4.3 长文本帖子
**输入**:
```
一段超过500字的长文本内容...
（需要输入足够长的文本）
```

**预期**:
- 类型：`text`
- 元数据：`suggestedLayout: 'expanded'`
- 日志：`Rule matched: post-long-text-detection`

#### 4.4 小说挑战
**输入**:
```
category: 'challenge'
text: "学习Harry Potter"
metadata: { novelId: 'hp-1' }
```

**预期**:
- 类型：`novel`
- 渲染：NovelCard
- 日志：`Rule matched: challenge-novel-detection`

---

### 五、快捷键测试

#### 5.1 快速发布
- [ ] 在输入框中输入内容
- [ ] 按 `Cmd+Enter` (Mac) 或 `Ctrl+Enter` (Windows)
- [ ] 内容立即提交，无需点击按钮

#### 5.2 关闭模态框
- [ ] 打开模态框
- [ ] 按 `Esc` 键
- [ ] 模态框关闭

---

### 六、边界情况测试

#### 6.1 空内容提交
- [ ] 不输入任何内容
- [ ] 发布按钮应该是禁用状态（灰色）
- [ ] 点击无反应

#### 6.2 超长内容
- [ ] 输入超过280字（帖子）或500字（挑战）
- [ ] 字符数变红色
- [ ] 发布按钮禁用
- [ ] 无法提交

#### 6.3 快速连续提交
- [ ] 提交一条内容
- [ ] 在Toast还在显示时，再次打开模态框
- [ ] 提交另一条内容
- [ ] 两条内容都应该正确创建

#### 6.4 网络错误模拟
- [ ] 打开开发者工具 → Network
- [ ] 设置为Offline
- [ ] 尝试提交内容
- [ ] 应该显示错误Toast（如果是Supabase模式）
- [ ] Mock模式不受影响

---

### 七、性能测试

#### 7.1 动画流畅度
- [ ] 打开/关闭FAB菜单，动画应该流畅（60fps）
- [ ] 打开/关闭模态框，动画应该流畅
- [ ] 卡片展开动画应该流畅

#### 7.2 响应速度
- [ ] 点击按钮到模态框出现：< 100ms
- [ ] 提交到Toast显示：< 100ms
- [ ] Mock模式创建：< 1s
- [ ] Feed刷新：< 500ms

#### 7.3 内存占用
- [ ] 打开Performance Monitor
- [ ] 创建10条帖子
- [ ] 内存增长应该合理（< 50MB）
- [ ] 关闭模态框后，内存应该释放

---

### 八、兼容性测试

#### 8.1 浏览器兼容
- [ ] Chrome (推荐)
- [ ] Firefox
- [ ] Safari
- [ ] Edge

#### 8.2 设备兼容
- [ ] 桌面端（1920x1080）
- [ ] 笔记本（1366x768）
- [ ] 平板（768x1024）
- [ ] 手机（375x667）

#### 8.3 暗色模式
- [ ] 切换到暗色模式
- [ ] 所有组件正常显示
- [ ] 颜色对比度合适

---

## 🐛 已知问题

### 1. 媒体上传未实现
**现状**: 媒体按钮只是占位符  
**计划**: 后续版本实现

### 2. 标签功能未完成
**现状**: 标签按钮存在但功能未实现  
**计划**: 后续版本实现

### 3. 挑战类型识别待完善
**现状**: 目前主要识别小说类型  
**计划**: 添加更多识别规则

---

## 📊 测试报告模板

### 测试环境
- 浏览器：Chrome 120
- 操作系统：macOS 14
- 测试时间：2025-01-25
- 测试人员：[你的名字]

### 测试结果
| 功能模块 | 测试项 | 通过 | 失败 | 备注 |
|---------|--------|------|------|------|
| FAB | 基础交互 | ✅ | - | 流畅 |
| FAB | 展开菜单 | ✅ | - | 动画完美 |
| 创建帖子 | 基础流程 | ✅ | - | 正常 |
| 创建挑战 | 基础流程 | ✅ | - | 正常 |
| 智能分发 | 类型识别 | ✅ | - | 准确 |
| 性能 | 动画流畅度 | ✅ | - | 60fps |

### 问题列表
1. [问题描述]
2. [问题描述]

### 建议
1. [改进建议]
2. [改进建议]

---

## 🚀 下一步

测试通过后：

1. **提交代码**
```bash
git add .
git commit -m "feat: 重构内容创建架构 - 两个核心入口+智能分发"
git push origin main
```

2. **更新文档**
- 更新README.md
- 更新API文档
- 更新用户指南

3. **部署验证**
- 部署到测试环境
- 进行完整回归测试
- 收集用户反馈

---

**测试愉快！** 🎉

如有问题，请查看：
- [内容创建架构.md](./内容创建架构.md)
- [项目概述.md](./项目概述.md)
